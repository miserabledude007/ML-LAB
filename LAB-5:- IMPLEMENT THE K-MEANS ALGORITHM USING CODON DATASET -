import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from sklearn.cluster import KMeans
from sklearn.datasets import load_iris
from sklearn.metrics import pairwise_distances_argmin_min

# Load the Iris dataset
iris = load_iris()
features = pd.DataFrame(iris.data, columns=iris.feature_names)

# Apply K-means clustering
kmeans = KMeans(n_clusters=3, random_state=42)
cluster_labels = kmeans.fit_predict(features)

# Print the cluster centers
print("Cluster Centers:")
print(kmeans.cluster_centers_)

# Find indices of the closest points to the cluster centers
distances = np.linalg.norm(features.values[:, np.newaxis] - kmeans.cluster_centers_, axis=2)
closest_indices = np.argmin(distances, axis=0)

print("\nIndices of Closest Points to Cluster Centers:")
print(closest_indices)

# Plot clusters
plt.figure(figsize=(10, 7))
plt.scatter(features.iloc[:, 0], features.iloc[:, 1], c=cluster_labels, cmap='viridis', s=50, alpha=0.7)
plt.scatter(kmeans.cluster_centers_[:, 0], kmeans.cluster_centers_[:, 1], c='red', s=200, marker='X', label='Centroids')
plt.title('K-means Clustering')
plt.xlabel('Feature 1')
plt.ylabel('Feature 2')
plt.legend()
plt.show()
